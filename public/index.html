<html>
<head>
	<title>minimal demo</title>
	<meta charset="iso-8859-1" />
	<script src="convnet-min.js"></script>
	<script type="text/javascript">
		var result;
		function periodic() {
			var d = document.getElementById("egdiv");
			var rand1 = Math.random() * 2 - 1;
			var rand2 = Math.random() * 4 - 2;
			var x = new convnetjs.Vol([rand1, rand2]);

			var probability_volume = net.forward(x);
			d.innerHTML = "Random number: " + rand1 + "  " + rand2 + ":" + probability_volume.w[0];
		}

		var net;
		function start() {
			var layers_def = [];

			layers_def.push({type:"input", out_sx:27, out_sy:12, out_depth:1});
			layers_def.push({type:"fc", num_neurons:20, activation:"relu"});
			layers_def.push({type:"fc", num_neurons:20, activation:"relu"});
			layers_def.push({type:"softmax", num_classes:2});

			net = new convnetjs.Net();
			net.makeLayers(layers_def);

			var trainer = new convnetjs.Trainer(net, {learning_rate:0.01, l2_decay:0.001});
			var x1 = new convnetjs.Vol(result.gestures[1][0].matrix);
			var x2 = new convnetjs.Vol(result.gestures[1][1].matrix);
			var y = new convnetjs.Vol(result.gestures[2][0].matrix);
			var prob_vol;

			/*
			trainer.train(x1, 0);
			trainer.train(x2, 0);
			trainer.train(y, 1);			
			*/

			for (var i = 1; i < result.gestures.length; i++) {
				for (var j = 0; j < result.gestures[i].length; j++) {
					var x = new convnetjs.Vol(result.gestures[i][j].matrix);
					trainer.train(x, i - 1);
				}
			}

			prob_vol = net.forward(x1);
			console.log(prob_vol);
			prob_vol = net.forward(y);
			console.log(prob_vol);
		}
		/*
		var load = function () {
			var xhttp = new XMLHttpRequest();
			xhttp.onreadystatechange = function() {
				if (this.readyState == 4 && this.status == 200) {
					result = JSON.parse(this.responseText);
					start();
				}
			};
			xhttp.open("GET", "00_01_1_0.js", true);
			xhttp.send();
		};
		*/
		var load = function () {
			result = localStorage.getItem("scc_715");
			result = JSON.parse(result);
			start();
		}
	</script>
</head>

<body onload="load()">
	<div id="egdiv"></div>
</body>
</html>
